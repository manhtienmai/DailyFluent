{% extends "layouts/sidebar_layout.html" %}
{% load static %}
{% load humanize %}

{% block title %}T·ª´ v·ª±ng c·ªßa t√¥i | DailyFluent{% endblock %}

{% block extra_css %}
<style>
  /* =============================================
     Frosted Crystal Design - macOS/iOS Aesthetic
     ============================================= */

  /* Pastel Gradient Mesh Background */
  .crystal-page {
    min-height: 100vh;
    background:
      radial-gradient(ellipse 80% 50% at 20% 40%, rgba(199, 210, 254, 0.5) 0%, transparent 50%),
      radial-gradient(ellipse 60% 50% at 80% 20%, rgba(251, 207, 232, 0.4) 0%, transparent 50%),
      radial-gradient(ellipse 50% 60% at 60% 80%, rgba(167, 243, 208, 0.3) 0%, transparent 50%),
      radial-gradient(ellipse 70% 40% at 10% 90%, rgba(254, 215, 170, 0.25) 0%, transparent 50%),
      linear-gradient(135deg, #f8fafc 0%, #f1f5f9 50%, #e2e8f0 100%);
    background-attachment: fixed;
    padding: 1.5rem;
  }

  [data-theme="dark"] .crystal-page {
    background:
      radial-gradient(ellipse 80% 50% at 20% 40%, rgba(99, 102, 241, 0.15) 0%, transparent 50%),
      radial-gradient(ellipse 60% 50% at 80% 20%, rgba(236, 72, 153, 0.1) 0%, transparent 50%),
      radial-gradient(ellipse 50% 60% at 60% 80%, rgba(16, 185, 129, 0.08) 0%, transparent 50%),
      linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
    background-attachment: fixed;
  }

  .crystal-container {
    max-width: 960px;
    margin: 0 auto;
  }

  /* ========== FROSTED GLASS PANELS ========== */
  .glass-panel {
    background: rgba(255, 255, 255, 0.72);
    backdrop-filter: blur(20px) saturate(180%);
    -webkit-backdrop-filter: blur(20px) saturate(180%);
    border: 1px solid rgba(255, 255, 255, 0.8);
    border-radius: 20px;
    box-shadow:
      0 4px 24px -4px rgba(99, 102, 241, 0.12),
      0 8px 48px -8px rgba(99, 102, 241, 0.08),
      inset 0 1px 0 rgba(255, 255, 255, 0.9);
  }

  [data-theme="dark"] .glass-panel {
    background: rgba(30, 41, 59, 0.75);
    border-color: rgba(148, 163, 184, 0.1);
    box-shadow:
      0 4px 24px -4px rgba(0, 0, 0, 0.4),
      0 8px 48px -8px rgba(0, 0, 0, 0.3),
      inset 0 1px 0 rgba(255, 255, 255, 0.05);
  }

  .glass-panel-light {
    background: rgba(255, 255, 255, 0.55);
    backdrop-filter: blur(16px) saturate(150%);
    -webkit-backdrop-filter: blur(16px) saturate(150%);
    border: 1px solid rgba(255, 255, 255, 0.6);
    border-radius: 16px;
    box-shadow:
      0 2px 16px -2px rgba(99, 102, 241, 0.1),
      inset 0 1px 0 rgba(255, 255, 255, 0.8);
  }

  [data-theme="dark"] .glass-panel-light {
    background: rgba(30, 41, 59, 0.6);
    border-color: rgba(148, 163, 184, 0.08);
    box-shadow:
      0 2px 16px -2px rgba(0, 0, 0, 0.3),
      inset 0 1px 0 rgba(255, 255, 255, 0.03);
  }

  /* ========== HEADER SECTION ========== */
  .crystal-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 1rem;
    padding: 1.25rem 1.5rem;
    margin-bottom: 1rem;
  }

  .crystal-title-group {
    display: flex;
    align-items: center;
    gap: 1rem;
  }

  .crystal-title {
    font-size: 1.375rem;
    font-weight: 700;
    color: #1e293b;
    letter-spacing: -0.025em;
  }

  [data-theme="dark"] .crystal-title {
    color: #f1f5f9;
  }

  .crystal-ready-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.375rem;
    padding: 0.375rem 0.875rem;
    background: linear-gradient(135deg, rgba(16, 185, 129, 0.15) 0%, rgba(52, 211, 153, 0.15) 100%);
    border: 1px solid rgba(16, 185, 129, 0.25);
    border-radius: 999px;
    font-size: 0.75rem;
    font-weight: 600;
    color: #059669;
    box-shadow: 0 2px 8px -2px rgba(16, 185, 129, 0.25);
  }

  [data-theme="dark"] .crystal-ready-badge {
    background: linear-gradient(135deg, rgba(16, 185, 129, 0.2) 0%, rgba(52, 211, 153, 0.15) 100%);
    color: #34d399;
  }

  .crystal-ready-badge svg {
    width: 14px;
    height: 14px;
  }

  .crystal-actions {
    display: flex;
    gap: 0.5rem;
  }

  .crystal-btn {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    border-radius: 12px;
    font-size: 0.8125rem;
    font-weight: 600;
    text-decoration: none;
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .crystal-btn svg {
    width: 16px;
    height: 16px;
  }

  .crystal-btn--primary {
    background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
    color: white;
    box-shadow:
      0 2px 8px -2px rgba(99, 102, 241, 0.5),
      inset 0 1px 0 rgba(255, 255, 255, 0.2);
  }

  .crystal-btn--primary:hover {
    transform: translateY(-1px);
    box-shadow:
      0 4px 16px -4px rgba(99, 102, 241, 0.6),
      inset 0 1px 0 rgba(255, 255, 255, 0.2);
  }

  .crystal-btn--ghost {
    background: rgba(255, 255, 255, 0.6);
    color: #475569;
    border: 1px solid rgba(148, 163, 184, 0.3);
    backdrop-filter: blur(8px);
  }

  .crystal-btn--ghost:hover {
    background: rgba(255, 255, 255, 0.85);
    border-color: rgba(99, 102, 241, 0.3);
    color: #6366f1;
  }

  [data-theme="dark"] .crystal-btn--ghost {
    background: rgba(51, 65, 85, 0.6);
    color: #94a3b8;
    border-color: rgba(148, 163, 184, 0.15);
  }

  [data-theme="dark"] .crystal-btn--ghost:hover {
    background: rgba(51, 65, 85, 0.8);
    color: #e2e8f0;
  }

  /* ========== QUICK STATS BAR ========== */
  .crystal-stats {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 0.75rem;
    padding: 1rem 1.25rem;
    margin-bottom: 1rem;
  }

  @media (max-width: 768px) {
    .crystal-stats {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  .crystal-stat {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.875rem 1rem;
    border-radius: 14px;
    background: rgba(255, 255, 255, 0.5);
    border: 1px solid rgba(255, 255, 255, 0.6);
    transition: all 0.2s ease;
  }

  [data-theme="dark"] .crystal-stat {
    background: rgba(51, 65, 85, 0.4);
    border-color: rgba(148, 163, 184, 0.1);
  }

  .crystal-stat:hover {
    background: rgba(255, 255, 255, 0.75);
    transform: translateY(-1px);
  }

  [data-theme="dark"] .crystal-stat:hover {
    background: rgba(51, 65, 85, 0.6);
  }

  .crystal-stat-icon {
    width: 36px;
    height: 36px;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }

  .crystal-stat-icon svg {
    width: 18px;
    height: 18px;
    color: white;
  }

  .crystal-stat-icon--indigo {
    background: linear-gradient(135deg, #6366f1 0%, #818cf8 100%);
    box-shadow: 0 4px 12px -4px rgba(99, 102, 241, 0.5);
  }
  .crystal-stat-icon--emerald {
    background: linear-gradient(135deg, #059669 0%, #34d399 100%);
    box-shadow: 0 4px 12px -4px rgba(5, 150, 105, 0.5);
  }
  .crystal-stat-icon--amber {
    background: linear-gradient(135deg, #d97706 0%, #fbbf24 100%);
    box-shadow: 0 4px 12px -4px rgba(217, 119, 6, 0.5);
  }
  .crystal-stat-icon--rose {
    background: linear-gradient(135deg, #e11d48 0%, #fb7185 100%);
    box-shadow: 0 4px 12px -4px rgba(225, 29, 72, 0.5);
  }

  .crystal-stat-content {
    flex: 1;
    min-width: 0;
  }

  .crystal-stat-value {
    font-size: 1.375rem;
    font-weight: 800;
    color: #1e293b;
    line-height: 1.2;
    letter-spacing: -0.03em;
  }

  [data-theme="dark"] .crystal-stat-value {
    color: #f1f5f9;
  }

  .crystal-stat-label {
    font-size: 0.6875rem;
    font-weight: 600;
    color: #64748b;
    text-transform: uppercase;
    letter-spacing: 0.04em;
  }

  [data-theme="dark"] .crystal-stat-label {
    color: #94a3b8;
  }

  /* SRS CTA Card */
  .crystal-stat--cta {
    cursor: pointer;
    text-decoration: none;
    border: 1px solid rgba(99, 102, 241, 0.2);
    background: linear-gradient(135deg, rgba(99, 102, 241, 0.08) 0%, rgba(139, 92, 246, 0.08) 100%);
  }

  .crystal-stat--cta:hover {
    border-color: rgba(99, 102, 241, 0.4);
    background: linear-gradient(135deg, rgba(99, 102, 241, 0.15) 0%, rgba(139, 92, 246, 0.12) 100%);
  }

  .crystal-stat--cta .crystal-stat-value {
    font-size: 0.9375rem;
    font-weight: 700;
    color: #6366f1;
  }

  [data-theme="dark"] .crystal-stat--cta .crystal-stat-value {
    color: #a5b4fc;
  }

  .crystal-stat-arrow {
    width: 18px;
    height: 18px;
    color: #94a3b8;
    transition: all 0.2s ease;
  }

  .crystal-stat--cta:hover .crystal-stat-arrow {
    color: #6366f1;
    transform: translateX(2px);
  }

  /* ========== GAMES FLOATING BAR ========== */
  .crystal-games {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem 1.25rem;
    margin-bottom: 1rem;
    overflow-x: auto;
    scrollbar-width: none;
  }

  .crystal-games::-webkit-scrollbar {
    display: none;
  }

  .crystal-games-label {
    font-size: 0.6875rem;
    font-weight: 700;
    color: #64748b;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    white-space: nowrap;
    padding-right: 0.5rem;
    border-right: 1px solid rgba(148, 163, 184, 0.3);
  }

  [data-theme="dark"] .crystal-games-label {
    color: #94a3b8;
    border-color: rgba(148, 163, 184, 0.15);
  }

  .crystal-game-chip {
    display: inline-flex;
    align-items: center;
    gap: 0.375rem;
    padding: 0.5rem 0.875rem;
    background: rgba(255, 255, 255, 0.7);
    border: 1px solid rgba(255, 255, 255, 0.8);
    border-radius: 10px;
    font-size: 0.75rem;
    font-weight: 600;
    color: #475569;
    text-decoration: none;
    white-space: nowrap;
    transition: all 0.2s ease;
    box-shadow: 0 2px 8px -2px rgba(99, 102, 241, 0.08);
  }

  [data-theme="dark"] .crystal-game-chip {
    background: rgba(51, 65, 85, 0.5);
    border-color: rgba(148, 163, 184, 0.1);
    color: #cbd5e1;
  }

  .crystal-game-chip:hover {
    background: rgba(255, 255, 255, 0.95);
    border-color: rgba(99, 102, 241, 0.3);
    color: #6366f1;
    transform: translateY(-1px);
    box-shadow: 0 4px 12px -4px rgba(99, 102, 241, 0.2);
  }

  [data-theme="dark"] .crystal-game-chip:hover {
    background: rgba(99, 102, 241, 0.15);
    border-color: rgba(99, 102, 241, 0.3);
    color: #a5b4fc;
  }

  .crystal-game-chip svg {
    width: 14px;
    height: 14px;
  }

  .crystal-game-chip--hot {
    position: relative;
  }

  .crystal-game-chip--hot::after {
    content: 'HOT';
    position: absolute;
    top: -6px;
    right: -6px;
    padding: 0.125rem 0.375rem;
    background: linear-gradient(135deg, #f43f5e 0%, #fb923c 100%);
    border-radius: 4px;
    font-size: 0.5rem;
    font-weight: 800;
    color: white;
    letter-spacing: 0.03em;
    box-shadow: 0 2px 6px -2px rgba(244, 63, 94, 0.5);
  }

  /* ========== LEARNING SETS ========== */
  .crystal-sets {
    margin-bottom: 1rem;
  }

  .crystal-section-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0.875rem 1.25rem;
    border-bottom: 1px solid rgba(148, 163, 184, 0.15);
  }

  .crystal-section-title {
    font-size: 0.6875rem;
    font-weight: 700;
    color: #64748b;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  [data-theme="dark"] .crystal-section-title {
    color: #94a3b8;
  }

  .crystal-sets-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  }

  .crystal-set-item {
    display: flex;
    align-items: center;
    gap: 0.875rem;
    padding: 0.875rem 1.25rem;
    text-decoration: none;
    border-bottom: 1px solid rgba(148, 163, 184, 0.08);
    transition: all 0.2s ease;
  }

  .crystal-set-item:last-child {
    border-bottom: none;
  }

  .crystal-set-item:hover {
    background: rgba(99, 102, 241, 0.04);
  }

  [data-theme="dark"] .crystal-set-item:hover {
    background: rgba(99, 102, 241, 0.08);
  }

  .crystal-set-info {
    flex: 1;
    min-width: 0;
  }

  .crystal-set-name {
    font-size: 0.875rem;
    font-weight: 600;
    color: #334155;
    margin-bottom: 0.375rem;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  [data-theme="dark"] .crystal-set-name {
    color: #e2e8f0;
  }

  .crystal-set-progress {
    display: flex;
    align-items: center;
    gap: 0.625rem;
  }

  .crystal-progress-track {
    flex: 1;
    height: 4px;
    background: rgba(148, 163, 184, 0.2);
    border-radius: 999px;
    overflow: hidden;
  }

  [data-theme="dark"] .crystal-progress-track {
    background: rgba(148, 163, 184, 0.15);
  }

  .crystal-progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #10b981 0%, #34d399 100%);
    border-radius: 999px;
    transition: width 0.4s ease;
  }

  .crystal-progress-text {
    font-size: 0.6875rem;
    font-weight: 600;
    color: #64748b;
    white-space: nowrap;
  }

  [data-theme="dark"] .crystal-progress-text {
    color: #94a3b8;
  }

  .crystal-set-arrow {
    width: 16px;
    height: 16px;
    color: #94a3b8;
    flex-shrink: 0;
    transition: all 0.2s ease;
  }

  .crystal-set-item:hover .crystal-set-arrow {
    color: #6366f1;
    transform: translateX(2px);
  }

  /* ========== FLOATING WORD LIST ========== */
  .crystal-words {
    overflow: hidden;
  }

  .crystal-words-header {
    display: grid;
    grid-template-columns: 1fr 120px 140px;
    gap: 1rem;
    padding: 0.625rem 1.25rem;
    background: rgba(248, 250, 252, 0.5);
    border-bottom: 1px solid rgba(148, 163, 184, 0.12);
  }

  [data-theme="dark"] .crystal-words-header {
    background: rgba(15, 23, 42, 0.3);
    border-color: rgba(148, 163, 184, 0.08);
  }

  .crystal-words-header span {
    font-size: 0.625rem;
    font-weight: 700;
    color: #64748b;
    text-transform: uppercase;
    letter-spacing: 0.06em;
  }

  [data-theme="dark"] .crystal-words-header span {
    color: #94a3b8;
  }

  .crystal-words-list {
    padding: 0.5rem;
  }

  /* Individual Word Row - The Floating Effect */
  .crystal-word-row {
    display: grid;
    grid-template-columns: 1fr 120px 140px;
    gap: 1rem;
    align-items: center;
    padding: 0.75rem 1rem;
    margin-bottom: 0.375rem;
    background: rgba(255, 255, 255, 0.55);
    border: 1px solid rgba(255, 255, 255, 0.7);
    border-radius: 12px;
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow:
      0 1px 3px rgba(99, 102, 241, 0.04),
      0 4px 12px -4px rgba(99, 102, 241, 0.06);
  }

  [data-theme="dark"] .crystal-word-row {
    background: rgba(51, 65, 85, 0.4);
    border-color: rgba(148, 163, 184, 0.08);
    box-shadow:
      0 1px 3px rgba(0, 0, 0, 0.1),
      0 4px 12px -4px rgba(0, 0, 0, 0.15);
  }

  .crystal-word-row:last-child {
    margin-bottom: 0;
  }

  .crystal-word-row:hover {
    background: rgba(255, 255, 255, 0.88);
    border-color: rgba(99, 102, 241, 0.2);
    transform: translateY(-2px);
    box-shadow:
      0 4px 12px rgba(99, 102, 241, 0.1),
      0 8px 24px -8px rgba(99, 102, 241, 0.15);
  }

  [data-theme="dark"] .crystal-word-row:hover {
    background: rgba(51, 65, 85, 0.65);
    border-color: rgba(99, 102, 241, 0.25);
    box-shadow:
      0 4px 12px rgba(0, 0, 0, 0.2),
      0 8px 24px -8px rgba(0, 0, 0, 0.25);
  }

  /* Word Cell */
  .crystal-word-cell {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    min-width: 0;
  }

  .crystal-word-index {
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(99, 102, 241, 0.08);
    border-radius: 6px;
    font-size: 0.6875rem;
    font-weight: 700;
    color: #6366f1;
    flex-shrink: 0;
  }

  [data-theme="dark"] .crystal-word-index {
    background: rgba(99, 102, 241, 0.15);
    color: #a5b4fc;
  }

  .crystal-word-text {
    font-size: 0.9375rem;
    font-weight: 700;
    color: #1e293b;
    letter-spacing: -0.01em;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  [data-theme="dark"] .crystal-word-text {
    color: #f1f5f9;
  }

  /* Status Pill Tags */
  .crystal-status {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    padding: 0.25rem 0.625rem;
    border-radius: 6px;
    font-size: 0.625rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.03em;
  }

  .crystal-status-dot {
    width: 5px;
    height: 5px;
    border-radius: 50%;
    background: currentColor;
  }

  .crystal-status--learning {
    background: linear-gradient(135deg, rgba(99, 102, 241, 0.12) 0%, rgba(139, 92, 246, 0.12) 100%);
    color: #6366f1;
    border: 1px solid rgba(99, 102, 241, 0.2);
  }

  [data-theme="dark"] .crystal-status--learning {
    background: linear-gradient(135deg, rgba(99, 102, 241, 0.2) 0%, rgba(139, 92, 246, 0.15) 100%);
    color: #a5b4fc;
    border-color: rgba(99, 102, 241, 0.25);
  }

  .crystal-status--review {
    background: linear-gradient(135deg, rgba(16, 185, 129, 0.12) 0%, rgba(52, 211, 153, 0.12) 100%);
    color: #059669;
    border: 1px solid rgba(16, 185, 129, 0.2);
  }

  [data-theme="dark"] .crystal-status--review {
    background: linear-gradient(135deg, rgba(16, 185, 129, 0.2) 0%, rgba(52, 211, 153, 0.15) 100%);
    color: #34d399;
    border-color: rgba(16, 185, 129, 0.25);
  }

  .crystal-status--relearning {
    background: linear-gradient(135deg, rgba(239, 68, 68, 0.12) 0%, rgba(248, 113, 113, 0.12) 100%);
    color: #dc2626;
    border: 1px solid rgba(239, 68, 68, 0.2);
  }

  [data-theme="dark"] .crystal-status--relearning {
    background: linear-gradient(135deg, rgba(239, 68, 68, 0.2) 0%, rgba(248, 113, 113, 0.15) 100%);
    color: #f87171;
    border-color: rgba(239, 68, 68, 0.25);
  }

  .crystal-status--new {
    background: rgba(148, 163, 184, 0.1);
    color: #64748b;
    border: 1px solid rgba(148, 163, 184, 0.2);
  }

  [data-theme="dark"] .crystal-status--new {
    background: rgba(148, 163, 184, 0.1);
    color: #94a3b8;
    border-color: rgba(148, 163, 184, 0.15);
  }

  /* Due Time */
  .crystal-due {
    font-size: 0.8125rem;
    color: #64748b;
    font-weight: 500;
  }

  [data-theme="dark"] .crystal-due {
    color: #94a3b8;
  }

  /* ========== PAGINATION ========== */
  .crystal-pagination {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.375rem;
    padding: 1rem 1.25rem;
    border-top: 1px solid rgba(148, 163, 184, 0.1);
    background: rgba(248, 250, 252, 0.3);
  }

  [data-theme="dark"] .crystal-pagination {
    background: rgba(15, 23, 42, 0.2);
    border-color: rgba(148, 163, 184, 0.06);
  }

  .crystal-page-btn {
    min-width: 32px;
    height: 32px;
    padding: 0 0.625rem;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 8px;
    background: rgba(255, 255, 255, 0.6);
    border: 1px solid rgba(255, 255, 255, 0.8);
    color: #475569;
    font-size: 0.8125rem;
    font-weight: 600;
    text-decoration: none;
    transition: all 0.15s ease;
    box-shadow: 0 1px 4px rgba(99, 102, 241, 0.05);
  }

  [data-theme="dark"] .crystal-page-btn {
    background: rgba(51, 65, 85, 0.5);
    border-color: rgba(148, 163, 184, 0.1);
    color: #94a3b8;
  }

  .crystal-page-btn:hover {
    background: rgba(255, 255, 255, 0.9);
    border-color: rgba(99, 102, 241, 0.3);
    color: #6366f1;
    transform: translateY(-1px);
  }

  [data-theme="dark"] .crystal-page-btn:hover {
    background: rgba(99, 102, 241, 0.15);
    color: #a5b4fc;
  }

  .crystal-page-btn.active {
    background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
    border-color: transparent;
    color: white;
    box-shadow: 0 2px 8px -2px rgba(99, 102, 241, 0.5);
  }

  .crystal-page-btn svg {
    width: 16px;
    height: 16px;
  }

  /* ========== EMPTY STATE ========== */
  .crystal-empty {
    text-align: center;
    padding: 4rem 2rem;
  }

  .crystal-empty-icon {
    width: 80px;
    height: 80px;
    margin: 0 auto 1.25rem;
    background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(139, 92, 246, 0.1) 100%);
    border: 1px solid rgba(99, 102, 241, 0.15);
    border-radius: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2rem;
  }

  .crystal-empty-title {
    font-size: 1rem;
    font-weight: 700;
    color: #1e293b;
    margin-bottom: 0.375rem;
  }

  [data-theme="dark"] .crystal-empty-title {
    color: #f1f5f9;
  }

  .crystal-empty-text {
    font-size: 0.875rem;
    color: #64748b;
    margin-bottom: 1.25rem;
  }

  [data-theme="dark"] .crystal-empty-text {
    color: #94a3b8;
  }

  /* ========== RESPONSIVE ========== */
  @media (max-width: 768px) {
    .crystal-page {
      padding: 1rem;
    }

    .crystal-header {
      flex-direction: column;
      align-items: flex-start;
      padding: 1rem 1.25rem;
    }

    .crystal-actions {
      width: 100%;
    }

    .crystal-btn {
      flex: 1;
      justify-content: center;
    }

    .crystal-words-header {
      grid-template-columns: 1fr 100px;
    }

    .crystal-words-header span:last-child {
      display: none;
    }

    .crystal-word-row {
      grid-template-columns: 1fr 100px;
    }

    .crystal-word-row > *:last-child {
      display: none;
    }
  }

  @media (max-width: 480px) {
    .crystal-title-group {
      flex-direction: column;
      align-items: flex-start;
      gap: 0.5rem;
    }
  }
</style>
{% endblock %}

{% block content %}
<div class="crystal-page">
  <div class="crystal-container">

    <!-- Frosted Header Panel -->
    <div class="glass-panel crystal-header">
      <div class="crystal-title-group">
        <h1 class="crystal-title">T·ª´ v·ª±ng c·ªßa t√¥i</h1>
        {% if ready_count > 0 %}
        <span class="crystal-ready-badge">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5">
            <circle cx="12" cy="12" r="10"/>
            <path d="M12 6v6l4 2"/>
          </svg>
          {{ ready_count }} t·ª´ s·∫µn s√†ng
        </span>
        {% endif %}
      </div>
      <div class="crystal-actions">
        <a href="{% url 'vocab:set_create' %}" class="crystal-btn crystal-btn--primary">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5">
            <path d="M12 5v14M5 12h14"/>
          </svg>
          T·∫°o b·ªô t·ª´
        </a>
        <a href="{% url 'vocab:set_list' %}?tab=my" class="crystal-btn crystal-btn--ghost">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
            <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/>
            <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/>
          </svg>
          B·ªô t·ª´ c·ªßa t√¥i
        </a>
      </div>
    </div>

    <!-- Stats Panel -->
    <div class="glass-panel-light crystal-stats">
      <div class="crystal-stat">
        <div class="crystal-stat-icon crystal-stat-icon--indigo">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25" />
          </svg>
        </div>
        <div class="crystal-stat-content">
          <div class="crystal-stat-value">{{ total_learning }}</div>
          <div class="crystal-stat-label">ƒêang h·ªçc</div>
        </div>
      </div>

      <div class="crystal-stat">
        <div class="crystal-stat-icon crystal-stat-icon--emerald">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
        </div>
        <div class="crystal-stat-content">
          <div class="crystal-stat-value">{{ mastered_count }}</div>
          <div class="crystal-stat-label">ƒê√£ thu·ªôc</div>
        </div>
      </div>

      <div class="crystal-stat">
        <div class="crystal-stat-icon crystal-stat-icon--amber">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
        </div>
        <div class="crystal-stat-content">
          <div class="crystal-stat-value">{{ ready_count }}</div>
          <div class="crystal-stat-label">C·∫ßn √¥n t·∫≠p</div>
        </div>
      </div>

      <a href="{% url 'vocab:set_list' %}?tab=my" class="crystal-stat crystal-stat--cta">
        <div class="crystal-stat-icon crystal-stat-icon--rose">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25H12" />
          </svg>
        </div>
        <div class="crystal-stat-content">
          <div class="crystal-stat-value">Flashcard SRS</div>
          <div class="crystal-stat-label">B·∫Øt ƒë·∫ßu √¥n t·∫≠p</div>
        </div>
        <svg class="crystal-stat-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"/>
        </svg>
      </a>
    </div>

    <!-- Games Floating Bar -->
    <div class="glass-panel-light crystal-games">
      <span class="crystal-games-label">Luy·ªán t·∫≠p</span>
      <a href="{% url 'vocab:game_mcq' %}" class="crystal-game-chip">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
        Tr·∫Øc nghi·ªám
      </a>
      <a href="{% url 'vocab:game_matching' %}" class="crystal-game-chip crystal-game-chip--hot">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6A2.25 2.25 0 016 3.75h2.25A2.25 2.25 0 0110.5 6v2.25a2.25 2.25 0 01-2.25 2.25H6a2.25 2.25 0 01-2.25-2.25V6z" />
        </svg>
        N·ªëi t·ª´
      </a>
      <a href="{% url 'vocab:game_listening' %}" class="crystal-game-chip">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424" />
        </svg>
        Nghe t·ª´
      </a>
      <a href="{% url 'vocab:game_fill' %}" class="crystal-game-chip">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931z" />
        </svg>
        ƒêi·ªÅn t·ª´
      </a>
      <a href="{% url 'vocab:game_dictation' %}" class="crystal-game-chip">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 18.75a6 6 0 006-6v-1.5m-6 7.5a6 6 0 01-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 01-3-3V4.5a3 3 0 116 0v8.25a3 3 0 01-3 3z" />
        </svg>
        Ch√≠nh t·∫£
      </a>
    </div>

    <!-- Learning Sets -->
    {% if learning_sets %}
    <div class="glass-panel crystal-sets">
      <div class="crystal-section-header">
        <span class="crystal-section-title">B·ªô t·ª´ ƒëang h·ªçc</span>
      </div>
      <div class="crystal-sets-list">
        {% for progress in learning_sets %}
        <a href="{% url 'vocab:course_set_detail' slug=progress.course_slug set_number=progress.vocabulary_set.set_number|default:1 %}" class="crystal-set-item">
          <div class="crystal-set-info">
            <div class="crystal-set-name">{{ progress.vocabulary_set.title }}</div>
            <div class="crystal-set-progress">
              <div class="crystal-progress-track">
                <div class="crystal-progress-fill" style="width: {% widthratio progress.words_learned progress.words_total 100 %}%;"></div>
              </div>
              <span class="crystal-progress-text">{{ progress.words_learned }}/{{ progress.words_total }}</span>
            </div>
          </div>
          <svg class="crystal-set-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"/>
          </svg>
        </a>
        {% endfor %}
      </div>
    </div>
    {% endif %}

    <!-- Floating Word List -->
    {% if cards %}
    <div class="glass-panel crystal-words">
      <div class="crystal-words-header">
        <span>T·ª´ v·ª±ng</span>
        <span>Tr·∫°ng th√°i</span>
        <span>√în t·∫≠p</span>
      </div>
      <div class="crystal-words-list">
        {% for card in cards %}
        <div class="crystal-word-row">
          <div class="crystal-word-cell">
            <span class="crystal-word-index">{{ forloop.counter }}</span>
            <span class="crystal-word-text">{{ card.vocab.word }}</span>
          </div>
          <div>
            {% if card.state == 1 %}
              <span class="crystal-status crystal-status--learning">
                <span class="crystal-status-dot"></span>
                ƒêang h·ªçc
              </span>
            {% elif card.state == 2 %}
              <span class="crystal-status crystal-status--review">
                <span class="crystal-status-dot"></span>
                √în t·∫≠p
              </span>
            {% elif card.state == 3 %}
              <span class="crystal-status crystal-status--relearning">
                <span class="crystal-status-dot"></span>
                H·ªçc l·∫°i
              </span>
            {% else %}
              <span class="crystal-status crystal-status--new">M·ªõi</span>
            {% endif %}
          </div>
          <div>
            <span class="crystal-due">{{ card.due|naturaltime }}</span>
          </div>
        </div>
        {% endfor %}
      </div>

      <!-- Pagination -->
      {% if is_paginated %}
      <div class="crystal-pagination">
        {% if page_obj.has_previous %}
        <a href="?page={{ page_obj.previous_page_number }}{% if request.GET.filter %}&filter={{ request.GET.filter }}{% endif %}" class="crystal-page-btn">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5">
            <path d="M15 18l-6-6 6-6"/>
          </svg>
        </a>
        {% endif %}

        {% for i in paginator.page_range %}
          {% if page_obj.number == i %}
            <span class="crystal-page-btn active">{{ i }}</span>
          {% elif i > page_obj.number|add:'-3' and i < page_obj.number|add:'3' %}
            <a href="?page={{ i }}{% if request.GET.filter %}&filter={{ request.GET.filter }}{% endif %}" class="crystal-page-btn">{{ i }}</a>
          {% endif %}
        {% endfor %}

        {% if page_obj.has_next %}
        <a href="?page={{ page_obj.next_page_number }}{% if request.GET.filter %}&filter={{ request.GET.filter }}{% endif %}" class="crystal-page-btn">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5">
            <path d="M9 18l6-6-6-6"/>
          </svg>
        </a>
        {% endif %}
      </div>
      {% endif %}
    </div>

    {% else %}
    <!-- Empty State -->
    <div class="glass-panel crystal-words">
      <div class="crystal-empty">
        <div class="crystal-empty-icon">üìö</div>
        <h3 class="crystal-empty-title">Ch∆∞a c√≥ t·ª´ v·ª±ng n√†o</h3>
        <p class="crystal-empty-text">B·∫Øt ƒë·∫ßu h·ªçc t·ª´ v·ª±ng ngay h√¥m nay</p>
        <a href="{% url 'vocab:course_list' %}" class="crystal-btn crystal-btn--primary">
          Kh√°m ph√° b·ªô t·ª´
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5">
            <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3" />
          </svg>
        </a>
      </div>
    </div>
    {% endif %}

  </div>
</div>
{% endblock %}
